identity:
  name: workflow_job
  author: langgenius
  label:
    en_US: Workflow Job (Unified)
    zh_Hans: 工作流任务（统一）
    ja_JP: ワークフロージョブ（統合）

description:
  en_US: Unified workflow_job event with actions filter
  zh_Hans: 带 actions 过滤的统一 workflow_job 事件
  ja_JP: アクションフィルタ付きの統合 workflow_job イベント

parameters:
- name: actions
  label:
    en_US: Actions
    zh_Hans: 动作
    ja_JP: アクション
  type: select
  required: false
  multiple: true
  default:
  - queued
  - in_progress
  - completed
  options:
  - value: queued
    label:
      en_US: Queued
      zh_Hans: 排队
      ja_JP: 待機
  - value: in_progress
    label:
      en_US: In Progress
      zh_Hans: 进行中
      ja_JP: 進行中
  - value: completed
    label:
      en_US: Completed
      zh_Hans: 已完成
      ja_JP: 完了
  description:
    en_US: Filter which workflow job actions to process. Leave empty to accept queued in_progress completed.
    zh_Hans: 选择要处理的工作流任务动作。留空接收 queued in_progress completed。
    ja_JP: ワークフロージョブのアクションを選択。未設定で queued in_progress completed を許可。

- name: workflow_name
  label:
    en_US: Workflow Name
    zh_Hans: 工作流名称
    ja_JP: ワークフロー名
  type: string
  required: false
  description:
    en_US: Exact match on workflow name from the job payload.
    zh_Hans: 按 job payload 中的工作流名称精确匹配。
    ja_JP: ジョブのペイロードに含まれるワークフロー名の完全一致。

- name: job_name
  label:
    en_US: Job Name
    zh_Hans: 任务名称
    ja_JP: ジョブ名
  type: string
  required: false
  description:
    en_US: Exact match on job name. Comma separated allowed.
    zh_Hans: 按任务名称精确匹配。支持逗号分隔。
    ja_JP: ジョブ名の完全一致。カンマ区切り可。

- name: branch
  label:
    en_US: Branch
    zh_Hans: 分支
    ja_JP: ブランチ
  type: string
  required: false
  description:
    en_US: Filter by head branch. Comma separated allowed.
    zh_Hans: 按 head 分支过滤。支持逗号分隔。
    ja_JP: head ブランチでフィルタ。カンマ区切り可。

- name: conclusion
  label:
    en_US: Conclusion (for completed)
    zh_Hans: 结论（仅 completed）
    ja_JP: 結論（completed のみ）
  type: string
  required: false
  description:
    en_US: Filter by job conclusion for completed actions. Example success failure cancelled.
    zh_Hans: 仅在 completed 动作时按任务结论过滤 如 success failure cancelled。
    ja_JP: completed 時のジョブ結論でフィルタ 例 success failure cancelled。

- name: runner_labels
  label:
    en_US: Runner Labels
    zh_Hans: 运行器标签
    ja_JP: ランナーラベル
  type: string
  required: false
  description:
    en_US: Comma separated runner labels required on the job. Matches if any label is present.
    zh_Hans: 逗号分隔的运行器标签。只要包含任意一个标签即匹配。
    ja_JP: ジョブに付与されたランナーラベル。カンマ区切りでいずれか一致。

- name: actor
  label:
    en_US: Actor
    zh_Hans: 触发者
    ja_JP: 実行者
  type: string
  required: false
  description:
    en_US: Filter by job actor login. Comma separated allowed.
    zh_Hans: 按执行者登录名过滤。支持逗号分隔。
    ja_JP: 実行者のログインでフィルタ。カンマ区切り可。

output_schema:
  type: object
  properties:
    action:
      type: string
    workflow_job:
      type: object
      properties:
        id:
          type: integer
        run_id:
          type: integer
        name:
          type: string
        workflow_name:
          type: string
        head_branch:
          type: string
        head_sha:
          type: string
        status:
          type: string
        conclusion:
          type: string
        html_url:
          type: string
          format: uri
        url:
          type: string
          format: uri
        started_at:
          type:
          - string
          - "null"
          format: date-time
        completed_at:
          type:
          - string
          - "null"
          format: date-time
        labels:
          type: array
          items:
            type: string
        runner_name:
          type:
          - string
          - "null"
        runner_id:
          type:
          - integer
          - "null"
      required:
      - id
      - run_id
      - name
      - head_branch
      - head_sha
      - status
    repository:
      type: object
      properties:
        id:
          type: integer
          format: int64
        full_name:
          type: string
        html_url:
          type: string
          format: uri
      required:
      - id
      - full_name
      - html_url
    sender:
      type: object
      properties:
        id:
          type: integer
        login:
          type: string
        type:
          type: string
      required:
      - id
      - login
      - type

  required:
  - action
  - workflow_job
  - repository
  - sender

extra:
  python:
    source: events/workflow_job/workflow_job.py
