identity:
  name: secret_scanning
  author: langgenius
  label:
    en_US: Secret Scanning
    zh_Hans: 秘密扫描
    ja_JP: シークレットスキャン

description:
  en_US: Unified event for secret scanning alerts, locations, and scans
  zh_Hans: 统一的秘密扫描事件，覆盖告警/位置/扫描
  ja_JP: シークレットスキャン（アラート/位置/スキャン統合）

parameters:
- name: subtypes
  label:
    en_US: Subtypes
    zh_Hans: 子类型
    ja_JP: サブタイプ
  type: select
  required: false
  multiple: true
  default:
  - alert
  - alert_location
  - scan
  options:
  - value: alert
    label:
      en_US: Alert
      zh_Hans: 告警
      ja_JP: アラート
  - value: alert_location
    label:
      en_US: Alert Location
      zh_Hans: 告警位置
      ja_JP: アラート位置
  - value: scan
    label:
      en_US: Scan
      zh_Hans: 扫描
      ja_JP: スキャン

- name: actions
  label:
    en_US: Actions
    zh_Hans: 动作
    ja_JP: アクション
  type: select
  required: false
  multiple: true
  description:
    en_US: Filter by actions (created,resolved,reopened,revoked; comma-separated)
    zh_Hans: 按动作过滤（created/resolved/reopened/revoked；逗号分隔）
    ja_JP: アクションでフィルタ（created/resolved/reopened/revoked、カンマ区切り）

- name: secret_type
  label:
    en_US: Secret Type
    zh_Hans: 秘密类型
    ja_JP: シークレット種類
  type: string
  required: false
  description:
    en_US: Filter by secret type key such as token or key name. Comma separated allowed.
    zh_Hans: 按秘密类型关键字过滤 如 token 或 key 名称。支持逗号分隔。
    ja_JP: シークレット種別のキーでフィルタ。token や key 名など。カンマ区切り可。

- name: severity
  label:
    en_US: Severity
    zh_Hans: 严重程度
    ja_JP: 重大度
  type: string
  required: false
  description:
    en_US: Filter by severity provided by secret scanning when available.
    zh_Hans: 按秘密扫描报告的严重程度过滤（如有）。
    ja_JP: 利用可能な場合 シークレットスキャンの重大度でフィルタ。

- name: branch
  label:
    en_US: Branch
    zh_Hans: 分支
    ja_JP: ブランチ
  type: string
  required: false
  description:
    en_US: Filter by branch for alert instances. Comma separated allowed.
    zh_Hans: 按产生告警实例的分支过滤。支持逗号分隔。
    ja_JP: アラートインスタンスのブランチでフィルタ。カンマ区切り可。

output_schema:
  type: object
  properties:
    action:
      type: string
    subtype:
      type: string
      enum:
      - alert
      - alert_location
      - scan
    alert:
      type: object
      description: Secret scanning alert object (if present)
      properties:
        number:
          type: integer
        secret_type:
          type: string
        secret_type_display_name:
          type: string
        state:
          type: string
        html_url:
          type: string
          format: uri
        resolved_at:
          type:
          - string
          - "null"
          format: date-time
        resolved_by:
          type:
          - object
          - "null"
          properties:
            id:
              type: integer
            login:
              type: string
        resolution:
          type:
          - string
          - "null"
        most_recent_instance:
          type:
          - object
          - "null"
          properties:
            ref:
              type: string
            location:
              type: object
              properties:
                path:
                  type: string
                start_line:
                  type: integer
                end_line:
                  type: integer
    location:
      type:
      - object
      - "null"
      description: Alert location payload (for alert_location subtype)
      properties:
        type:
          type: string
        details:
          type: object
          properties:
            path:
              type: string
            start_line:
              type: integer
            end_line:
              type: integer
            start_column:
              type: integer
            end_column:
              type: integer
    scan:
      type:
      - object
      - "null"
      description: Secret scanning scan payload (for scan subtype)
      properties:
        id:
          type: integer
        status:
          type: string
        started_at:
          type: string
          format: date-time
        completed_at:
          type:
          - string
          - "null"
          format: date-time
    repository:
      type: object
      description: The repository where the alert was generated
      properties:
        id:
          type: integer
          format: int64
        node_id:
          type: string
        name:
          type: string
        full_name:
          type: string
        private:
          type: boolean
        owner:
          type: object
          properties:
            id:
              type: integer
            login:
              type: string
            node_id:
              type: string
            avatar_url:
              type: string
              format: uri
            html_url:
              type: string
              format: uri
            type:
              type: string
              enum:
              - Bot
              - User
              - Organization
            site_admin:
              type: boolean
          required:
          - id
          - login
        html_url:
          type: string
          format: uri
        description:
          type:
          - string
          - "null"
        fork:
          type: boolean
        url:
          type: string
          format: uri
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        pushed_at:
          type:
          - string
          - "null"
          format: date-time
        stargazers_count:
          type: integer
        watchers_count:
          type: integer
        language:
          type:
          - string
          - "null"
        forks_count:
          type: integer
        open_issues_count:
          type: integer
        default_branch:
          type: string
        topics:
          type: array
          items:
            type: string
        visibility:
          type: string
          enum:
          - public
          - private
          - internal
      required:
      - id
      - node_id
      - name
      - full_name
      - private
      - owner
      - html_url
      - url
      - created_at
      - updated_at
      - fork
      - default_branch
      - visibility
    sender:
      type: object
      description: The user who triggered the event
      properties:
        id:
          type: integer
        login:
          type: string
        node_id:
          type: string
        avatar_url:
          type: string
          format: uri
        html_url:
          type: string
          format: uri
        type:
          type: string
          enum:
          - Bot
          - User
          - Organization
        site_admin:
          type: boolean
      required:
      - id
      - login
      - type

  required:
  - action
  - repository
  - sender

extra:
  python:
    source: events/secret_scanning/secret_scanning.py
  help:
    en_US: Choose which secret scanning subtype to handle. alert is the main alert object. alert_location reports locations. scan reports scan runs.
    zh_Hans: 选择要处理的秘密扫描子类型。alert 为主告警对象 alert_location 为告警位置 scan 为扫描运行。
    ja_JP: 取り扱うサブタイプを選択します。alert はメインの警告 alert_location は位置情報 scan はスキャン実行です。
  help:
    en_US: Filter by secret scanning actions for alerts such as created resolved reopened revoked.
    zh_Hans: 按秘密扫描告警的动作过滤 如 created resolved reopened revoked。
    ja_JP: シークレットスキャンのアクションでフィルタ created resolved reopened revoked など。
